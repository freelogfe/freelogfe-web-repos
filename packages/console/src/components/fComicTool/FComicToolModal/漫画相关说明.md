漫画文件

```json
{
  // 漫画文件名
  "name": "条漫2306251650",
  // 漫画类型/阅读模式 1-条漫 2-页漫 3-日漫
  "mode": 1,
  // 漫画图片有序队列
  "list": [
    {
      // 图片名称
      "name": "001.jpg",
      // 图片大小
      "size": 199430,
      // 图片宽度
      "width": 625,
      // 图片高度
      "height": 960
    }
    // ...
  ],
  // 漫画配置（包含原漫画文件 xml 中的配置）
  "config": {},
  // 用户自定义数据
  "custom": {}
}
```

### 漫画文件格式

漫画格式为对应格式改名而来，压缩包内容多张图片（PNG、JPG、JPEG 等）。

- CBZ: ZIP
- CBR: RAR
- CBT: TAR
- CB7: 7Z
- CBA: ACE

### 解析漫画格式思路

将漫画格式视作对应的压缩包格式处理。

1. 使用漫画格式所对应格式的解压插件，解压该压缩包；
2. 获取图片内容（blob/base64）
3. 渲染图片

### 方案

##### 漫画格式解析

目前已支持解析 CBZ、CBT、CBR（仅支持 RAR4 不支持 RAR，RAR 实际是 RAR5 版本，相比于 RAR4 的 128 位加密算法，RAR 使用 256 位 AES 加密算法） 格式的漫画压缩文件。

##### 漫画资源导出格式

在漫画排版工具排版完成后，可以支持用户导出以下格式文件：

- ZIP：目前绝大多数压缩文件格式为 ZIP，导出 ZIP 压缩包能让用户更加方便处理文件；
- CBZ：可以确定能导出 CBZ 漫画格式文件，使用户可以直接将导出的文件使用于漫画相关软件。CBR、CBT 等格式暂未找到压缩插件，不确定是否可以实现。

##### 漫画资源在 freelog 存储方式：

漫画资源可用于**漫画排版工具**与**主题**，基于“漫画即图片集”的共识，可以给出以下方案，将漫画资源存储为：

- CBZ/ZIP 包

  因运行时不支持 CDN，且因为沙盒?问题导致运行时无法支持解压库，因此节点侧（主题）可能无法解析压缩包，或使主题的开发成本与门槛极大提高。

- JSON 配置文件

  可以在漫画排版工具保存时，将漫画图片上传至服务器，将对应的 URL 写入 JSON 配置文件。在节点侧（主题）渲染漫画时无需考虑解压问题，通过配置文件中的 URL 即可渲染漫画图片，对主题开发者不增加任何开发成本，比较友好；JSON 配置灵活，排版调整顺序时无需往服务器存储新的压缩包，如果有新的图片导入，也仅仅需要对新图片做增量上传即可。
